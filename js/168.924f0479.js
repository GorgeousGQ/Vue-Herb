"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[168],{2168:function(t,e,s){s.r(e),s.d(e,{default:function(){return p}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"root"},[e("div",{ref:"navContainer",staticClass:"nav-container"}),e("div",{staticClass:"box"},[e("div",{staticClass:"content"},[e("div",{staticClass:"main"},[t._m(0),e("div",{staticClass:"top-box"},[e("div",{staticClass:"top-box-left"},[e("div",{staticClass:"article-info"},[e("div",{staticClass:"article-title"},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",rules:t.pubFormRules}},[e("el-form-item",{staticClass:"change-label-calss",attrs:{label:"标题",prop:"title"}},[e("el-input",{attrs:{placeholder:"请书写文章标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),e("el-form-item",{staticClass:"change-label-calss",attrs:{label:"概述",prop:"articledesc"}},[e("el-input",{attrs:{placeholder:"请书写文章概述"},model:{value:t.form.articledesc,callback:function(e){t.$set(t.form,"articledesc",e)},expression:"form.articledesc"}})],1),e("el-form-item",{staticClass:"change-label-calss",staticStyle:{display:"inline-block"},attrs:{label:"标签",prop:"region"}},[e("el-select",{attrs:{placeholder:"请选择文章标签"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[e("el-option",{attrs:{label:"标签1",value:"shanghai"}}),e("el-option",{attrs:{label:"标签2",value:"beijing"}})],1)],1)],1)],1)])]),e("div",{staticClass:"top-box-right"},[e("div",{staticClass:"article-pic"},[e("el-upload",{ref:"uploadRef",staticClass:"upload-demo",attrs:{drag:"",action:"#","on-change":t.onChange,"file-list":t.picFile,"auto-upload":!1,accept:".jpeg, .png, .jpg","before-upload":t.beforeUpload,multiple:""}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),e("em",[t._v("点击上传")])]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])])],1)]),t._m(1)]),e("div",{staticClass:"bottom-box"},[e("div",{staticClass:"bottom-info"},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",size:"medium",rules:t.pubFormRules,prop:"content"}},[e("quill-editor",{model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1)]),e("div",{staticClass:"submitbtn"},[e("el-row",[e("el-button",{on:{click:function(e){return t.resetFn()}}},[t._v("清空")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.pubArticleFn()}}},[t._v("提交")]),e("el-button",{attrs:{type:"info"},on:{click:function(e){return t.pubArticleFn("草稿")}}},[t._v("保存草稿")])],1)],1)])])])])},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"write-title"},[e("h3",[t._v("创作服务平台")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"top-middle"},[e("div",{staticClass:"pic-limit"},[e("h2",[t._v("图片大小/格式")]),e("p",[t._v("图片上传大小不超过10MB")]),e("p",[t._v("图片上传格式为jpg、png格式")])]),e("div",{staticClass:"article-limit"},[e("h2",[t._v("图片分辨率")]),e("p",[t._v("推荐上传宽高比为3:4、分辨率不低于720*960的照片，超过1280p的图片用网页端上传画质更加清晰")])])])}],l=s(7877),r=s(4161),o={data(){return{form:{title:"",articledesc:"",content:"",authorId:this.$store.state.userInfo.id,time:""},index:0,picFile:[],pubFormRules:{title:[{required:!0,message:"请输入文章标题！",trigger:"blur"},{min:1,max:30,message:"文章标题长度为1-30个字符",trigger:"blur"}],articledesc:[{required:!0,message:"请输入文章简介！",trigger:"blur"},{min:1,max:30,message:"文章简介长度为1-30个字符",trigger:"blur"}],content:[{required:!0,message:"请输入文章正文！",trigger:"blur"}]}}},mounted(){const t=this.$moment(new Date).format("YYYY年MM月DD月 HH时mm分ss秒");this.form.time=t},methods:{onChange(t){this.picFile[this.index]=t,this.index++,console.log(this.picFile)},async uploadPic(){let t=new FormData;this.picFile.forEach(((e,s)=>{t.append("imgFile",this.picFile[s].raw)})),(0,r.Z)({url:"http://8.130.20.53:3000/admin/addArticlePic",method:"POST",headers:{"Content-Type":"multipart/form-data",Authorization:localStorage.getItem("token")},data:t,params:{articleinfo:this.form}}).then((t=>{200==t.status?this.$message({type:"success",message:"图片上传成功"}):this.$message({type:"error",message:"图片上传失败"})}))},beforeUpload(t){},resetFn(){},async pubArticleFn(){if(""==this.form.title)this.$message({type:"warning",message:"文章标题不能为空！"});else if(""==this.form.articledesc)this.$message({type:"warning",message:"文章概述不能为空！"});else if(""==this.form.content)this.$message({type:"warning",message:"文章正文内容不能为空！"});else{const{data:t}=await(0,l._X)(this.form);if(0!==t.status)return this.$message.error(t.message);this.uploadPic(),this.$message({type:"success",message:"文章已上传，将在审批后发布到网站中，请耐心等待！"})}}}},n=o,c=s(1001),m=(0,c.Z)(n,i,a,!1,null,"99b4d176",null),p=m.exports}}]);
//# sourceMappingURL=168.924f0479.js.map